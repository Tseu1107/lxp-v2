import React, {useState} from "react";
import { Modal, Button } from "react-bootstrap";
import { useTranslation } from "react-i18next";
import { fetchRequest } from 'utils/fetchRequest'
import { studentCouncilJoinRequest } from 'utils/fetchRequest/Urls';
import message from 'modules/message'
import { useLocation } from "react-router-dom";

const InviteModal = ({
    onClose = () => { isSubmit },
    show = false,
    object
}) => {
    const { t } = useTranslation();
    const location = useLocation();

    const [loading, setLoading] = useState(false)
    const [isApproved, setIsApproved] = useState(false)
    const [isSubmit, setIsSubmit] = useState(false)
    const [descriptionValue, setDescriptionValue] = useState('')

    const onSubmit = () => {
        if(!descriptionValue){
            message(t('council.errorMessage.enterDescription'), false)
            return
        }

        const params = {
            council: object.id,
            purpose: descriptionValue,
        }

        setLoading(true)
        fetchRequest(studentCouncilJoinRequest, "POST", params)
            .then(res => {
                if (res.success) {
                    setIsApproved(true)
                    setIsSubmit(true)
                    setLoading(false)
                } else {
                    message(res.message)
                    setLoading(false)
                }
            })
            .catch(() => {
                message(t('errorMessage.title'));
                setLoading(false)
            })
    }

    const descriptionHandler = (event) => {
        setDescriptionValue(event.target.value);
    }

    const modalClose = () => {
        onClose(isSubmit)
    }

    return (
        <Modal
            show={show}
            onHide={modalClose}
            size='xl'
            aria-labelledby="contained-modal-title-vcenter"
            centered
        >
            <Modal.Header className="p-3">
                <Modal.Title className="d-flex flex-row justify-content-between w-100 black-color fs-20">
                    {t('council.invite')}
                    <button type="button" className="btn-close" onClick={modalClose} />
                </Modal.Title>
            </Modal.Header>
            <Modal.Body style={{padding: '1rem 1rem 2rem 1rem'}}>
                {
                    isApproved
                    ?
                        <div>
                            <div className="col-12 text-center mt-6">
                                {/* <img
                                    className="profile"
                                    alt={object.name}
                                    src={'/public/img/student/icons/invite.png'}
                                /> */}
                                <InviteSvg />
                                <p className="fs-16 font-weight-400 black-color mt-6">{t('council.thankText')}</p>
                            </div>
                            
                        </div>
                    :
                        <div>
                            <div className="col-12">
                                <div className="fs-16" dangerouslySetInnerHTML={{ __html: object.description || '' }} />
                            </div>
                            <div className="col-12 mt-3" style={{padding: '2rem'}}>
                                <p className="fs-16">{t('council.inviteDescription')}</p>
                                <textarea  
                                    style={{width: '100%'}}
                                    rows={15}
                                    value={descriptionValue}
                                    className="form-control resize-vertical"
                                    onChange={descriptionHandler}
                                />
                            </div>
                        </div>
                }
            </Modal.Body>
            <Modal.Footer className="p-3">
                <div className="d-flex flex-row justify-content-center align-items-center w-100">
                    {
                        isApproved
                        ?
                            <Button className='btn btn-primary' variant='empty' onClick={modalClose} style={{padding: '8px 20px'}}>
                                <span className="fs-14">{t('common.close')}</span>
                            </Button>
                        :
                            <Button className='btn btn-primary' variant='empty' onClick={onSubmit} style={{padding: '8px 20px'}}>
                                <span className="fs-14">{t('common.send')}</span>
                            </Button>
                    }
                </div>
            </Modal.Footer>
            {
                loading &&
                <>
                    <div className='loader-container'>
                        <svg className="splash-spinner" viewBox="0 0 50 50">
                            <circle className="path" cx="25" cy="25" r="20" fill="none" strokeWidth="5" />
                        </svg>
                    </div>
                </>
            }
        </Modal>
    );
};

export default InviteModal;

const InviteSvg = () => {
    return <svg xmlns="http://www.w3.org/2000/svg" width="138" height="174" viewBox="0 0 138 174" fill="none">
        <path d="M55.0667 170.725C54.5367 170.725 54.0467 170.375 53.8867 169.845C53.6967 169.195 54.0667 168.515 54.7167 168.315L61.1567 166.415L60.9467 141.445C60.9467 140.765 61.4868 140.215 62.1668 140.205H62.1767C62.8467 140.205 63.3967 140.745 63.4067 141.425L63.6367 168.245L55.4267 170.675C55.3067 170.705 55.1967 170.725 55.0767 170.725" fill="#3A2842"/>
        <path d="M60.4169 159.845L64.6168 159.525C65.3068 159.475 65.9068 160.025 65.8968 160.715L65.8368 169.695C65.8368 170.285 65.4068 170.775 64.8268 170.865L54.0568 172.485C53.5168 172.565 52.9868 172.265 52.7768 171.755C50.4768 166.325 55.9568 165.275 58.5068 165.075C59.1768 165.025 59.6668 164.435 59.5968 163.765L59.3268 161.155C59.2568 160.495 59.7469 159.895 60.4169 159.845Z" fill="#3A2842"/>
        <path d="M85.6666 171.525C85.4966 171.525 85.3166 171.485 85.1466 171.405L80.3366 169.175L75.2567 142.805C75.1267 142.135 75.5666 141.495 76.2266 141.365C76.8866 141.235 77.5366 141.675 77.6666 142.335L82.5166 167.475L86.1866 169.185C86.8066 169.475 87.0666 170.205 86.7866 170.815C86.5766 171.265 86.1366 171.525 85.6766 171.525" fill="#3A2842"/>
        <path d="M77.8665 161.425L82.6165 160.505C83.2865 160.375 83.9265 160.815 84.0565 161.475L84.5765 164.185C84.6665 164.675 85.0464 165.055 85.5264 165.155C87.7464 165.625 93.6665 167.415 91.0765 172.895C90.8065 173.465 90.1365 173.745 89.5365 173.515L78.7764 169.505C78.3764 169.355 78.0865 169.005 77.9965 168.585L76.8866 162.845C76.7566 162.185 77.1965 161.535 77.8565 161.415" fill="#3A2842"/>
        <path d="M114.197 154.055C113.767 154.055 113.347 153.825 113.117 153.415C112.787 152.825 113.007 152.075 113.607 151.745L119.027 148.775C120.317 144.515 129.787 111.625 126.387 76.7649C126.317 76.0949 126.817 75.4849 127.487 75.4249C128.167 75.3649 128.767 75.8549 128.827 76.5249C132.507 114.225 121.337 149.635 121.227 149.985C121.127 150.285 120.927 150.535 120.647 150.685L114.787 153.895C114.597 153.995 114.397 154.045 114.197 154.045" fill="#3A2842"/>
        <path d="M28.7669 147.695C28.6469 147.695 28.5169 147.675 28.3969 147.635L22.0869 145.615C21.8969 145.555 21.7169 145.445 21.5769 145.305C21.3369 145.055 15.7069 139.185 12.2369 128.765C9.04686 119.175 7.20688 103.805 16.5769 84.985C16.8769 84.375 17.6169 84.1251 18.2269 84.4351C18.8369 84.7351 19.0869 85.4751 18.7769 86.0851C9.7869 104.155 11.5269 118.845 14.5669 127.995C17.4969 136.805 22.1269 142.255 23.1369 143.375L29.1469 145.295C29.7969 145.505 30.1469 146.195 29.9369 146.835C29.7669 147.355 29.2869 147.685 28.7669 147.685" fill="#3A2842"/>
        <path d="M130.977 79.7651C124.397 99.3751 113.237 117.275 100.177 129.265C93.9966 134.945 87.3966 139.295 80.6566 141.875C68.1866 146.645 55.6266 144.525 44.8166 137.495C42.7566 136.155 40.7466 134.625 38.8166 132.935C26.3266 121.995 17.0367 104.085 14.4167 83.0151C13.6667 76.9851 13.4566 70.6851 13.8866 64.2251C14.1166 60.6851 14.4566 57.4451 14.8866 54.4851C19.8366 20.2651 36.8666 24.0551 42.4266 51.6351C42.8666 53.7851 43.2266 56.0951 43.5166 58.5351C43.6266 59.4851 44.9867 59.5451 45.1667 58.6051C50.3867 30.4651 67.6467 15.4151 80.7367 21.1551C95.6267 -2.45486 125.257 -10.9549 134.287 20.2651C134.447 20.8151 134.597 21.3652 134.747 21.9352C139.417 40.2552 137.347 60.8151 130.977 79.7751" fill="#FABC1E"/>
        <path d="M85.4269 80.4754C80.7669 80.4754 76.537 76.8354 73.607 70.1954C69.287 60.3955 68.7469 49.0355 72.0569 37.3355C73.5569 32.0355 75.787 26.9254 78.617 22.2254C75.717 21.3354 72.327 21.0854 68.607 22.2454C67.957 22.4454 67.2669 22.0854 67.0669 21.4354C66.8669 20.7854 67.2269 20.0954 67.8769 19.8954C71.9069 18.6354 75.997 18.7154 79.967 20.0654C82.657 15.9754 85.817 12.2454 89.337 9.0154C89.837 8.5554 90.6169 8.58547 91.0669 9.08547C91.5169 9.58547 91.487 10.3655 90.997 10.8255C87.737 13.8155 84.8069 17.2554 82.2769 21.0154C83.6369 21.6554 84.9769 22.4554 86.2869 23.4154C95.2369 29.9054 101.127 42.2855 101.297 54.9555C101.467 67.4155 95.3669 78.5254 87.4169 80.2654C86.7469 80.4154 86.0769 80.4854 85.4269 80.4854M80.9469 23.1254C78.1169 27.7454 75.8969 32.7854 74.4169 38.0154C71.2669 49.1554 71.767 59.9453 75.857 69.2153C78.727 75.7253 82.6569 78.7954 86.9069 77.8654C92.7869 76.5854 99.027 67.4754 98.857 54.9954C98.697 43.0754 93.197 31.4654 84.857 25.4154C83.747 24.6054 82.4369 23.7954 80.9469 23.1254Z" fill="#CC8D06"/>
        <path d="M88.5566 62.4652C88.3866 66.5752 85.4367 69.0252 83.2567 66.8752C81.0767 64.7252 81.2866 59.5952 83.6466 57.6352C86.0066 55.6752 88.7266 58.3652 88.5566 62.4752" fill="#3A2842"/>
        <path d="M61.7567 68.2552C62.0567 70.9852 60.4967 72.8953 58.9467 71.6853C57.3867 70.4753 57.0067 67.0552 58.2667 65.5352C59.5167 64.0152 61.4667 65.5352 61.7667 68.2552" fill="#3A2842"/>
        <path d="M69.1366 94.5453C68.7866 94.5453 68.4466 94.3952 68.2066 94.1152C65.1566 90.5552 64.2766 88.9053 64.7366 87.5753C65.1366 86.4053 66.3266 86.1752 67.2766 85.9752C68.2966 85.7652 68.9366 85.6053 69.2066 85.0453C69.5666 84.3053 69.7267 82.1352 66.6667 76.0152C66.3667 75.4052 66.6066 74.6752 67.2166 74.3652C67.8266 74.0652 68.5566 74.3053 68.8666 74.9153C71.6766 80.5353 72.4667 83.9852 71.4167 86.1152C70.5867 87.8052 68.8866 88.1552 67.7666 88.3752C67.5866 88.4152 67.3467 88.4552 67.1667 88.5052C67.3567 88.9752 67.9966 90.0652 70.0766 92.5052C70.5166 93.0252 70.4566 93.7952 69.9466 94.2352C69.7166 94.4352 69.4266 94.5353 69.1466 94.5353" fill="#3A2842"/>
        <path d="M97.8968 116.565C95.9068 117.565 94.0168 116.905 94.4968 115.385C94.9768 113.865 97.4768 112.615 98.9868 113.145C100.497 113.665 99.8868 115.575 97.8968 116.575" fill="#CC8D06"/>
        <path d="M113.807 74.2653C118.257 78.5353 115.327 95.0554 101.407 105.335C87.4966 115.615 70.1267 114.745 66.2167 111.235C62.2967 107.725 64.7967 101.185 81.8267 94.4453C98.8567 87.7153 109.357 69.9953 113.797 74.2653" fill="#F7F1EB"/>
        <path d="M99.7984 81.4283L97.978 83.083L106.978 92.984L108.798 91.3293L99.7984 81.4283Z" fill="#D1CDC9"/>
        <path d="M87.6549 91.5949L85.5059 92.792L93.9588 107.966L96.1078 106.769L87.6549 91.5949Z" fill="#D1CDC9"/>
        <path d="M71.9317 101.86L69.6182 102.696L74.0503 114.96L76.3639 114.124L71.9317 101.86Z" fill="#D1CDC9"/>
        <path d="M42.3265 34.6052C41.9465 34.6052 41.5665 34.4253 41.3265 34.0853C40.9365 33.5353 41.0665 32.7652 41.6165 32.3752C47.7165 28.0452 48.9065 25.4752 48.6865 24.7152C48.5665 24.3152 47.6465 23.8053 45.4365 23.7053C43.2065 23.6053 41.7165 23.2952 41.2365 22.0952C40.6865 20.7452 41.8165 19.5552 43.5265 17.7452C45.2765 15.8952 47.6665 13.3552 49.2165 9.8752C49.4965 9.2552 50.2165 8.9752 50.8365 9.2552C51.4565 9.5252 51.7365 10.2552 51.4565 10.8752C49.7365 14.7452 47.0665 17.5653 45.3065 19.4353C44.7865 19.9853 44.1765 20.6353 43.8265 21.0853C44.1565 21.1453 44.6865 21.2152 45.5465 21.2552C48.6965 21.3952 50.5465 22.3352 51.0465 24.0252C51.7965 26.5852 49.1065 30.0652 43.0465 34.3752C42.8365 34.5252 42.5865 34.6052 42.3365 34.6052" fill="#3A2842"/>
        <path d="M54.7866 5.66483C53.8066 7.37483 52.0966 7.80485 51.7066 6.44485C51.3266 5.08486 52.5466 2.95477 53.9166 2.60477C55.2866 2.25477 55.7666 3.95483 54.7766 5.66483" fill="#3A2842"/>
        <path d="M42.4267 51.6254L14.8867 54.4754C19.8367 20.2554 36.8667 24.0454 42.4267 51.6254Z" fill="#4E7BDE"/>
        <path d="M4.13671 60.845C2.37671 60.845 1.38674 60.115 0.916735 59.605C-0.363265 58.225 -0.293301 56.0051 1.0667 54.1951C3.0767 51.5351 7.93674 49.715 15.1067 53.225L42.2967 50.4051C42.9767 50.3351 43.5767 50.8251 43.6467 51.5051C43.7167 52.1751 43.2267 52.785 42.5567 52.855L15.0167 55.7051C14.7867 55.7351 14.5467 55.6851 14.3367 55.5751C8.34672 52.5351 4.50668 53.7351 3.04668 55.6751C2.42668 56.5051 2.28668 57.4551 2.73668 57.9351C3.52668 58.7851 6.14668 58.5551 10.0467 56.0551C10.6167 55.6851 11.3767 55.8551 11.7467 56.4251C12.1167 56.9951 11.9467 57.7551 11.3767 58.1251C8.1367 60.1951 5.80673 60.845 4.15673 60.845" fill="#3455BA"/>
        <path d="M14.8864 55.7155C14.4164 55.7155 13.9665 55.4456 13.7665 54.9856L8.36643 42.6856C8.09643 42.0656 8.37643 41.3356 8.99643 41.0656C9.61643 40.7956 10.3464 41.0757 10.6164 41.6957L16.0165 53.9956C16.2865 54.6156 16.0064 55.3456 15.3864 55.6156C15.2264 55.6856 15.0565 55.7155 14.8965 55.7155" fill="#3455BA"/>
        <path d="M100.167 129.275C93.9866 134.955 87.3866 139.305 80.6466 141.885C68.1766 146.655 55.6166 144.535 44.8066 137.505C55.3666 133.895 78.0266 127.435 100.167 129.285" fill="#3A2842"/>
        <path d="M116.727 160.745C116.597 160.745 116.467 160.725 116.337 160.685C115.697 160.465 115.347 159.775 115.567 159.125L118.897 149.215C119.067 148.725 119.517 148.395 120.037 148.375C120.547 148.355 121.017 148.675 121.207 149.155L123.877 155.985C124.127 156.615 123.807 157.325 123.177 157.575C122.547 157.825 121.837 157.505 121.587 156.875L120.147 153.195L117.897 159.895C117.727 160.405 117.247 160.735 116.737 160.735" fill="#3A2842"/>
        <path d="M27.2667 152.715C26.8767 152.715 26.4867 152.525 26.2467 152.175L23.2967 147.855L22.8568 151.625C22.7768 152.295 22.1667 152.775 21.4967 152.705C20.8267 152.625 20.3368 152.015 20.4168 151.345L21.2367 144.305C21.2967 143.795 21.6668 143.375 22.1568 143.255C22.6568 143.135 23.1768 143.335 23.4668 143.755L28.2768 150.795C28.6567 151.355 28.5167 152.115 27.9567 152.505C27.7467 152.655 27.5067 152.715 27.2667 152.715Z" fill="#3A2842"/>
        <path d="M38.817 132.936C26.327 121.996 17.037 104.086 14.417 83.0156C41.147 98.0556 40.247 123.416 38.817 132.936Z" fill="#CC8D06"/>
        <path d="M130.977 79.7649C123.347 66.9749 112.527 40.9549 134.287 20.2549C134.447 20.8049 134.597 21.3549 134.747 21.9249C139.417 40.2449 137.347 60.8049 130.977 79.7649Z" fill="#CC8D06"/>
    </svg>
}