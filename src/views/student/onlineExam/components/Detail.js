import ArrowLeftIcon from 'cs-line-icons/custom/ArrowLeftIcon'
import message from 'modules/message'
import React, { useEffect, useState } from 'react'
import { Button, Col, Row } from 'react-bootstrap'
import { useTranslation } from 'react-i18next'
import { useHistory, useLocation } from 'react-router-dom/cjs/react-router-dom'
import { fetchRequest } from 'utils/fetchRequest'

const Detail = () => {
    const { id } = useLocation()?.state || {}
    const {t} = useTranslation()

    const history = useHistory()

    const [item,setItem] = useState({})
    const [loading,setLoading] = useState(false)

    const onStartExam = (id) => {
        setLoading(true)
        fetchRequest('api/student/exam/start',"POST", { exam: id })
            .then(res=>{
                if(res.success) {
                    history.replace({
                        pathname: "/exam/exam",
                        state: { id }
                    })
                } else {
                    message(res.message)
                }
            })
            .catch(e=>{
                message(t('errorMessage.title'));
            })
            .finally(()=>{
                setLoading(false)
            })
    }

    const fetchInit = () => {
        setLoading(true)
        fetchRequest('api/student/exam/info',"POST",{ exam: id })
            .then(res=>{
                if (res.success) {
                    setItem(res.exam)
                } else {
                    message(res.message)
                }
            })
            .catch(e=>{
                message(t('errorMessage.title'));
            })
            .finally(()=>{
                setLoading(false)
            })
    }

    useEffect(()=>{
        if(id) {
            fetchInit()
        }
    },[id])

    return (
        <>
            <div className="student-page-title-container mb-0">
                <Button variant='empty' onClick={()=>history.goBack()}>
                    <ArrowLeftIcon/>
                </Button>
                <h1 className="mb-0 pb-0 display-4">{t('common.back')}</h1>
            </div>

            <Row className='d-flex align-items-center justify-content-center p-5 background-white' style={{marginLeft: '-26px', marginRight: '0'}}>
                <Col lg={6} xs={9} className='d-flex flex-column align-items-center p-0'>
                    <DisplayImage/>

                    <h6 style={{color: '#8993A5'}} className='mt-4'>{item.subjectName || ''}</h6>

                    <h3 className='mt-5'>{item.name || ''}</h3>

                    <p className='text-center mt-3 text-medium' style={{color: '#8993A5'}}>{item.description || ''}</p>
                    
                    <h5 className='mb-5'>
                        {item.questionCount} {t('onlineExam.question')} &#9679; {item.duration} {t('common.minute')} &#9679; {item.startDate} - {item.endDate}
                    </h5>

                    <div className='d-flex flex-row align-items-start mb-5'>
                        <ExclamationMark/>
                        <div className='d-flex flex-column ml-4'>
                            <p className='text-medium m-0' style={{color: '#FF003D'}}>&#9679; {t('onlineExam.warning1')}</p>
                            <p className='text-medium m-0' style={{color: '#FF003D'}}>&#9679; {t('onlineExam.warning2')}</p>
                        </div>
                    </div>

                    <Button variant='primary' onClick={()=>onStartExam(item.id)}>
                        {t('onlineExam.start')}
                    </Button>
                </Col>
            </Row>

            {
                loading &&
                <>
                    <div className='loader-container'>
                        <svg className="splash-spinner" viewBox="0 0 50 50">
                            <circle className="path" cx="25" cy="25" r="20" fill="none" strokeWidth="5" />
                        </svg>
                    </div>
                </>
            }
        </>
    )
}

export default Detail

const DisplayImage = () => {
    return <svg width="204" height="200" viewBox="0 0 204 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M192.812 63.0052L192.361 79.0021C207.92 79.0021 205.302 54.9379 192.812 63.0052Z" fill="#6F42A6"/>
        <path d="M143.857 141.073C139.623 142.927 85.7946 147.061 48.3391 146.485H48.3265C29.3357 146.197 14.5664 144.693 12.6122 141.073C6.79968 130.325 4.70786 45.5677 9.04219 41.3586C13.3765 37.1496 24.1119 40.4567 39.257 34.306L45.3578 34.4062L145.185 36.0848C145.185 36.0848 150.221 138.267 143.844 141.073" fill="#FABC1E"/>
        <path d="M143.857 141.073C139.623 142.927 85.7947 147.061 48.3391 146.485H48.3266C48.3266 146.485 47.2119 107.088 45.3453 34.4188H45.3579L145.185 36.0974C145.185 36.0974 150.221 138.28 143.845 141.086" fill="#CC8D06"/>
        <path d="M22.8844 60.9007C22.2205 60.9007 21.6693 60.3746 21.6442 59.6982C21.6192 59.2096 21.2182 47.7224 23.1098 37.8887C23.235 37.2123 23.8863 36.7738 24.5628 36.8991C25.2392 37.0244 25.6777 37.6758 25.5525 38.3648C23.711 47.9228 24.1245 59.4977 24.1371 59.6105C24.1621 60.2994 23.6232 60.8757 22.9342 60.9007C22.9217 60.9007 22.8969 60.9007 22.8844 60.9007Z" fill="#CC8D06"/>
        <path d="M31.0143 142.752C30.5759 142.752 30.1498 142.526 29.9243 142.113L10.1944 106.612C9.85617 106.01 10.0818 105.259 10.6831 104.92C11.2844 104.582 12.0484 104.808 12.3741 105.409L32.104 140.91C32.4422 141.512 32.2169 142.276 31.6156 142.601C31.4277 142.702 31.2148 142.752 31.0143 142.752Z" fill="#CC8D06"/>
        <path d="M45.3579 135.223C44.957 135.223 44.5686 135.035 44.3306 134.684L26.7928 109.092C26.4045 108.528 26.5423 107.752 27.1185 107.363C27.6823 106.975 28.4591 107.113 28.8474 107.689L46.3851 133.281C46.7735 133.845 46.6231 134.622 46.0594 135.01C45.8465 135.161 45.5959 135.223 45.3579 135.223Z" fill="#CC8D06"/>
        <path d="M15.2931 130.325C14.9048 130.325 14.5289 130.15 14.2909 129.812C13.89 129.26 14.0027 128.471 14.5665 128.07L36.0877 112.361C36.6388 111.961 37.4282 112.073 37.8291 112.637C38.2299 113.188 38.1172 113.977 37.5535 114.378L16.032 130.075C15.8065 130.237 15.5562 130.313 15.3056 130.313" fill="#CC8D06"/>
        <path d="M22.847 140.823C22.4337 140.823 22.0202 140.61 21.7947 140.234C21.4314 139.645 21.6069 138.881 22.1956 138.518L44.3432 124.751C44.9319 124.387 45.6962 124.563 46.0595 125.151C46.4228 125.74 46.2473 126.504 45.6586 126.868L23.511 140.635C23.3106 140.76 23.0851 140.823 22.8596 140.823" fill="#CC8D06"/>
        <path d="M47.2745 109.343H7.92713C7.23815 109.343 6.67444 108.791 6.67444 108.102C6.67444 107.413 7.23815 106.862 7.92713 106.862H47.2745C47.9634 106.862 48.5146 107.426 48.5146 108.102C48.5146 108.779 47.9634 109.343 47.2745 109.343Z" fill="#CC8D06"/>
        <path d="M182.979 116.909L177.154 123.423C135.076 130.25 58.0601 129.924 54.6402 127.482C51.2329 125.039 51.7091 121.669 51.7091 121.669L182.979 116.896V116.909Z" fill="#3A2842"/>
        <path d="M118.991 118.487C122.511 129.912 130.215 124.124 130.215 118.487H118.991Z" fill="#6F42A6"/>
        <path d="M192.361 113.151C192.524 82.2341 193.739 48.474 194.416 31.7506C194.654 25.9255 190.032 21.0526 184.194 20.9649C100.527 19.8374 38.6432 21.1152 38.6432 21.1152L41.7248 121.343C80.4581 123.36 171.128 117.685 189.192 116.508C190.971 116.395 192.349 114.917 192.361 113.138" fill="#9F69E0"/>
        <path d="M39.232 39.8808L59.0873 20.8148L38.6558 21.1154L39.232 39.8808Z" fill="#46A686"/>
        <path d="M42.8524 22.5808C42.0006 22.5808 41.3116 21.8918 41.3116 21.0399V2.36226C41.3116 1.51043 42.0006 0.821472 42.8524 0.821472C43.7043 0.821472 44.3932 1.51043 44.3932 2.36226V21.0399C44.3932 21.8918 43.7043 22.5808 42.8524 22.5808Z" fill="#46A686"/>
        <path d="M40.1838 24.5726C39.8456 24.5726 39.5074 24.4598 39.2318 24.2343L28.7845 15.929C28.1206 15.4029 28.0079 14.4383 28.534 13.7744C29.0602 13.1104 30.0372 12.9977 30.7012 13.5238L41.1484 21.8292C41.8124 22.3553 41.925 23.3199 41.3989 23.9838C41.0983 24.3596 40.6473 24.56 40.1964 24.56" fill="#46A686"/>
        <path d="M40.184 27.5289C40.0713 27.5289 39.9585 27.5289 39.8583 27.4913L27.4568 24.773C26.63 24.5976 26.1039 23.7708 26.2793 22.9441C26.4672 22.1173 27.2814 21.5912 28.1082 21.7666L40.5098 24.4849C41.3365 24.6603 41.8629 25.487 41.6875 26.3138C41.5372 27.0278 40.8981 27.5289 40.184 27.5289Z" fill="#46A686"/>
        <path d="M37.1276 3.2894C37.1276 5.81984 34.3842 7.39822 32.192 6.133C29.9998 4.86778 29.9998 1.71098 32.192 0.445755C34.3842 -0.819467 37.1276 0.758953 37.1276 3.2894Z" fill="#46A686"/>
        <path d="M117.225 68.9933C116.649 69.1937 116.035 69.2939 115.396 69.2939H111.838C110.936 69.2939 110.21 68.5674 110.21 67.6655V53.9986C110.21 52.9212 111.049 52.0569 112.126 52.0193L117.275 51.8439C118.928 51.7938 120.332 53.0465 120.444 54.7001L120.657 57.5938L121.071 63.2059C121.271 65.8616 119.605 68.1916 117.225 68.9933Z" fill="#F7F1EB"/>
        <path d="M117.225 68.9934C115.959 68.58 114.82 67.7407 114.03 66.4504C111.638 62.542 114.381 57.5061 118.966 57.3934C119.567 57.3809 120.131 57.4435 120.657 57.5938L121.07 63.2059C121.271 65.8616 119.605 68.1916 117.225 68.9934Z" fill="#3A2842"/>
        <path d="M160.067 66.3875C160.167 67.327 159.428 68.1663 158.476 68.1663H154.342C151.461 68.1663 149.143 65.8363 149.143 62.9676V54.5621C149.143 53.0714 150.346 51.8688 151.837 51.8688H156.334C157.524 51.8688 158.514 52.7582 158.651 53.9482L159.052 57.5184L160.055 66.4L160.067 66.3875Z" fill="#F7F1EB"/>
        <path d="M160.067 66.3874C160.167 67.327 159.428 68.1662 158.476 68.1662H154.643C154.142 67.7529 153.703 67.2518 153.328 66.6505C150.91 62.6795 153.678 57.581 158.326 57.4683C158.576 57.4683 158.827 57.4682 159.065 57.4933L160.067 66.3749V66.3874Z" fill="#3A2842"/>
        <path d="M147.841 198.86C147.528 198.86 147.227 198.785 146.939 198.609L135.163 191.732C134.6 191.406 134.261 190.793 134.274 190.129L135.965 126.843C135.99 125.853 136.817 125.064 137.807 125.101C138.796 125.126 139.573 125.953 139.548 126.943L137.882 189.164L148.73 195.503C149.582 196.004 149.87 197.106 149.369 197.958C149.031 198.534 148.43 198.847 147.816 198.847" fill="#2B253D"/>
        <path d="M114.181 200C113.893 200 113.605 199.925 113.329 199.787C112.452 199.311 112.126 198.234 112.603 197.357L116.06 190.968L110.135 127.557C110.047 126.567 110.774 125.69 111.751 125.602C112.74 125.515 113.617 126.241 113.705 127.218L119.68 191.168C119.718 191.519 119.643 191.882 119.467 192.183L115.747 199.06C115.421 199.662 114.807 200 114.168 200" fill="#2B253D"/>
        <path d="M40.0839 67.728C33.8455 54.8628 22.2706 61.7276 20.7048 71.7241C19.1264 81.7331 29.3983 91.4415 40.5473 82.585L40.0965 67.728H40.0839Z" fill="#9F69E0"/>
        <path d="M36.6894 86.4933C36.489 86.4933 36.2757 86.4557 36.0753 86.368C27.1185 82.4471 27.6573 78.6639 29.2983 74.1041C30.4257 70.9599 31.4153 68.2415 26.7678 64.1828C26.129 63.6191 26.0665 62.6545 26.6177 62.0156C27.1814 61.3767 28.1459 61.3141 28.7848 61.8653C35.0107 67.3145 33.3821 71.8493 32.1796 75.1564C30.9394 78.5888 30.263 80.4803 37.2907 83.5494C38.0673 83.8877 38.4305 84.7896 38.0797 85.5788C37.8292 86.155 37.2656 86.5058 36.6643 86.5058" fill="#6F42A6"/>
        <path d="M180.736 86.9066C177.855 86.9066 174.961 85.6664 172.669 83.8374C172.005 83.3113 171.892 82.3467 172.431 81.6828C172.97 81.0189 173.934 80.9061 174.598 81.4448C179.145 85.0776 183.116 84.0003 185.146 81.996C187.062 80.0794 187.989 76.5718 185.459 73.3774C183.58 71.0098 181.588 71.2228 180.561 71.5611C179.045 72.0621 177.918 73.3774 177.88 74.7178C177.83 76.2085 179.12 77.5614 181.525 78.5385C182.315 78.8517 182.69 79.7537 182.377 80.5429C182.064 81.3321 
            181.162 81.7079 180.373 81.3947C175.225 79.3027 174.773 75.958 174.811 74.6176C174.899 71.9995 176.878 69.5442 179.609 68.6423C182.615 67.6526 185.697 68.7174 187.889 71.4734C191.422 75.9455 190.282 81.2444 187.326 84.1882C185.371 86.1299 183.079 86.9316 180.761 86.9316" fill="#6F42A6"/>
        <path d="M87.2981 91.0656C81.9616 91.0656 78.2285 88.5728 76.2492 85.6164C73.343 81.2696 73.8817 75.6325 77.5772 71.5988C80.2579 68.6675 84.2039 67.7906 87.8868 69.2813C91.1689 70.6217 93.2985 73.4903 93.2108 76.4216C93.1481 78.3383 92.0583 81.8834 85.4316 84.0882C84.6173 84.3512 83.7529 83.9253 83.4898 83.111C83.2268 82.3093 83.6527 81.4324 84.467 81.1694C88.0246 79.9793 90.0916 78.213 90.1543 76.3214C90.2044 74.6929 88.8014 72.9767 86.747 72.1374C85.82 71.7616 
            82.563 70.7469 79.8697 73.6782C77.1012 76.6972 76.6878 80.7184 78.8299 83.9002C80.9845 87.1196 86.0327 89.5499 93.7368 86.7313C94.5385 86.4432 95.4155 86.8566 95.7036 87.6458C95.9917 88.435 95.5909 89.3244 94.7892 89.6125C92.0332 90.6272 89.5404 91.0531 87.3106 91.0531" fill="#6F42A6"/>
        <path d="M166.293 45.5677C166.142 45.5677 165.992 45.5426 165.842 45.5051C161.031 44.0394 159.039 41.4965 157.286 39.2541C155.444 36.8991 153.979 35.0325 149.381 34.3185C148.542 34.1932 147.966 33.404 148.104 32.5647C148.229 31.7254 149.018 31.1492 149.857 31.287C155.645 32.1889 157.799 34.9448 159.704 37.3625C161.32 39.4295 162.848 41.3837 166.731 42.5612C167.545 42.8118 167.996 43.6636 167.758 44.4778C167.558 45.1418 166.944 45.5677 166.293 45.5677Z" fill="#3A2842"/>
        <path d="M105.149 16.7557C104.698 16.7557 104.234 16.5553 103.934 16.167C103.408 15.503 103.533 14.5259 104.197 14.0123C106.878 11.9203 110.31 11.9328 113.63 11.9453C118.152 11.9704 122.812 11.9955 126.745 7.21016C127.284 6.55876 128.261 6.45856 128.912 6.99722C129.564 7.53588 129.664 8.51296 129.125 9.16436C124.265 15.0646 118.365 15.0395 113.617 15.0145C110.573 15.0019 107.93 14.9894 106.101 16.4175C105.813 16.643 105.487 16.7432 105.149 16.7432" fill="#3A2842"/>
        <path d="M39.2319 41.4089C38.831 41.4089 38.4178 41.246 38.1171 40.9329C37.5283 40.319 37.5534 39.342 38.1547 38.7532L58.0097 19.6872C58.6236 19.0984 59.6007 19.1234 60.1894 19.7373C60.7782 20.3511 60.7534 21.3282 60.1396 21.917L40.2842 40.983C39.9836 41.2711 39.5951 41.4089 39.2193 41.4089" fill="#3A2842"/>
        <path d="M50.8067 140.447C50.5687 140.447 50.3309 140.397 50.1054 140.271C49.3538 139.883 49.0531 138.956 49.4289 138.204C49.4915 138.067 56.2559 124.688 58.6486 108.127C61.8304 86.2051 56.2685 69.4065 42.1381 58.1823C41.4742 57.6562 41.3615 56.6916 41.8877 56.0277C42.4138 55.3638 43.3783 55.251 44.0548 55.7772C58.9118 67.5776 65.0125 85.8544 61.6803 108.653C59.2 125.69 52.4478 139.044 52.1597 139.595C51.8841 140.134 51.3453 140.434 50.7941 140.434" fill="#FABC1E"/>
        <path d="M141.69 86.1176C139.711 95.9137 128.9 100.098 122.236 93.6588C115.571 87.22 118.039 74.9686 126.683 71.6239C135.326 68.2667 143.669 76.3215 141.69 86.1176Z" fill="#3A2842"/>
        <path d="M6.74976 140.823C6.12341 140.823 5.58477 140.347 5.50961 139.72L0.887237 98.6319C0.849656 98.2936 0.949847 97.9554 1.17533 97.6924L6.21119 91.6669C6.64963 91.1408 7.43871 91.0656 7.96484 91.504C8.49097 91.9425 8.56629 92.7317 8.12785 93.2578L3.44278 98.8824L8.00246 139.445C8.07762 140.134 7.58921 140.747 6.90023 140.823C6.85012 140.823 6.81241 140.823 6.7623 140.823" fill="#CC8D06"/>
    </svg>
    
}

const ExclamationMark = () => {
    return <svg width="44" height="44" viewBox="0 0 44 44" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M22 13.6666V22M22 30.3333H22.0208M42.8333 
        22C42.8333 33.5059 33.5059 42.8333 22 42.8333C10.494 
        42.8333 1.16663 33.5059 1.16663 22C1.16663 10.494 
        10.494 1.16663 22 1.16663C33.5059 1.16663 42.8333 
        10.494 42.8333 22Z" stroke="#FF003D" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
    </svg>
}
